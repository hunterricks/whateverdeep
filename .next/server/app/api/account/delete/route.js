"use strict";(()=>{var e={};e.id=599,e.ids=[599],e.modules={11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{e.exports=require("assert")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},22037:e=>{e.exports=require("os")},63477:e=>{e.exports=require("querystring")},76224:e=>{e.exports=require("tty")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},32420:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>q,requestAsyncStorage:()=>g,routeModule:()=>y,serverHooks:()=>b,staticGenerationAsyncStorage:()=>v});var o={};r.r(o),r.d(o,{DELETE:()=>h});var a=r(49303),i=r(88716),s=r(60670),n=r(87070),p=r(64099),u=r(2021),d=r(71732),c=r(7998),l=r(46923),m=r(27401);async function h(){try{let e=await (0,p.getSession)();if(!e?.user)return n.NextResponse.json({error:"Unauthorized"},{status:401});if(await (0,u.Z)(),await Promise.all([d.Z.findByIdAndDelete(e.user.sub),c.Z.deleteMany({postedBy:e.user.sub}),l.Z.deleteMany({serviceProvider:e.user.sub}),m.Z.deleteMany({$or:[{reviewer:e.user.sub},{reviewee:e.user.sub}]})]),!(await fetch(`dev-tv1tri5qe7ysjzi0.us.auth0.com/api/v2/users/${e.user.sub}`,{method:"DELETE",headers:{Authorization:`Bearer ${process.env.AUTH0_MANAGEMENT_API_TOKEN}`}})).ok)throw Error("Failed to delete Auth0 user");return n.NextResponse.json({message:"Account deleted successfully"})}catch(e){return console.error("Error deleting account:",e),n.NextResponse.json({error:"Failed to delete account"},{status:500})}}let y=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/account/delete/route",pathname:"/api/account/delete",filename:"route",bundlePath:"app/api/account/delete/route"},resolvedPagePath:"/Users/hunterricks/Downloads/stackblitz-starters-3acn8s (7)/app/api/account/delete/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:g,staticGenerationAsyncStorage:v,serverHooks:b}=y,f="/api/account/delete/route";function q(){return(0,s.patchFetch)({serverHooks:b,staticGenerationAsyncStorage:v})}},2021:(e,t,r)=>{r.d(t,{Z:()=>n});var o=r(11185),a=r.n(o);if(!process.env.MONGODB_URI)throw Error("Please define the MONGODB_URI environment variable");let i=process.env.MONGODB_URI,s=global.mongooseCache;s||(s=global.mongooseCache={conn:null,promise:null});let n=async function(){if(s.conn)return s.conn;s.promise||(s.promise=a().connect(i,{bufferCommands:!1}).then(e=>e.connection));try{s.conn=await s.promise}catch(e){throw s.promise=null,e}return s.conn}},7998:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(11185),a=r.n(o);r(71732);let i=new(a()).Schema({title:{type:String,required:[!0,"Please provide a title for this job."],maxlength:[100,"Title cannot be more than 100 characters"]},description:{type:String,required:[!0,"Please provide a description for this job."],maxlength:[2e3,"Description cannot be more than 2000 characters"]},category:{type:String,required:[!0,"Please specify the category of this job."],enum:["renovation","plumbing","electrical","painting","landscaping","cleaning","other"]},location:{type:String,required:[!0,"Please specify the location for this job."]},budget:{type:Number,min:[0,"Budget cannot be negative"]},minHourlyRate:{type:Number,min:[0,"Hourly rate cannot be negative"]},maxHourlyRate:{type:Number,min:[0,"Hourly rate cannot be negative"]},budgetType:{type:String,enum:["fixed","hourly"],required:[!0,"Please specify the budget type."]},scope:{type:String,required:[!0,"Please specify the scope of this job."],enum:["small","medium","large"]},duration:{type:String,required:[!0,"Please specify the duration of this job."],enum:["1-3","3-6","6+"]},experienceLevel:{type:String,required:[!0,"Please specify the required experience level."],enum:["entry","intermediate","expert"]},skills:[{type:String,required:[!0,"Please specify at least one required skill."]}],postedBy:{type:a().Schema.Types.ObjectId,ref:"User",required:[!0,"Please provide the user who posted this job."]},status:{type:String,enum:["open","in_progress","completed","cancelled"],default:"open"},paymentStatus:{type:String,enum:["pending","escrow","released","refunded"],default:"pending"},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});i.pre("save",function(e){this.updatedAt=new Date,e()});let s=a().models.Job||a().model("Job",i)},46923:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(11185),a=r.n(o);let i=new(a()).Schema({job:{type:a().Schema.Types.ObjectId,ref:"Job",required:[!0,"Please provide the job this proposal is for."]},serviceProvider:{type:a().Schema.Types.ObjectId,ref:"User",required:[!0,"Please provide the service provider submitting this proposal."]},coverLetter:{type:String,required:[!0,"Please provide a cover letter for this proposal."],maxlength:[1e3,"Cover letter cannot be more than 1000 characters"]},price:{type:Number,required:[!0,"Please provide a price for this proposal."]},estimatedDuration:{type:String,required:[!0,"Please provide an estimated duration for this job."]},status:{type:String,enum:["pending","accepted","rejected"],default:"pending"},createdAt:{type:Date,default:Date.now}}),s=a().models.Proposal||a().model("Proposal",i)},27401:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(11185),a=r.n(o);let i=new(a()).Schema({job:{type:a().Schema.Types.ObjectId,ref:"Job",required:[!0,"Please provide the job this review is for."]},reviewer:{type:a().Schema.Types.ObjectId,ref:"User",required:[!0,"Please provide the user who wrote this review."]},reviewee:{type:a().Schema.Types.ObjectId,ref:"User",required:[!0,"Please provide the user who is being reviewed."]},rating:{type:Number,required:[!0,"Please provide a rating."],min:1,max:5},comment:{type:String,required:[!0,"Please provide a comment for this review."],maxlength:[500,"Comment cannot be more than 500 characters"]},createdAt:{type:Date,default:Date.now}}),s=a().models.Review||a().model("Review",i)},71732:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(11185),a=r.n(o);let i=new(a()).Schema({name:{type:String,required:[!0,"Please provide a name"],maxlength:[60,"Name cannot be more than 60 characters"]},email:{type:String,required:[!0,"Please provide an email"],unique:!0,lowercase:!0,trim:!0},password:{type:String,required:[!0,"Please provide a password"],minlength:[8,"Password must be at least 8 characters long"]},fcmTokens:[{type:String}],createdAt:{type:Date,default:Date.now}}),s=a().models.User||a().model("User",i)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[9276,5972,4099],()=>r(32420));module.exports=o})();