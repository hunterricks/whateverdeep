"use strict";(()=>{var e={};e.id=1567,e.ids=[1567],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},16147:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>v,requestAsyncStorage:()=>g,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>y});var a={};r.r(a),r.d(a,{GET:()=>d});var n=r(49303),o=r(88716),i=r(60670),s=r(87070),u=r(41482),p=r.n(u),c=r(2021),l=r(7998);async function d(e){try{let t=e.cookies.get("auth-token")?.value;if(!t)return s.NextResponse.json({error:"Unauthorized"},{status:401});let r=p().verify(t,process.env.JWT_SECRET);await (0,c.Z)();let a=await l.Z.countDocuments({postedBy:r.userId}),n=await l.Z.countDocuments({postedBy:r.userId,status:"completed"}),o=await l.Z.aggregate([{$match:{postedBy:r.userId}},{$group:{_id:null,averageBudget:{$avg:"$budget"}}}]),i=o[0]?.averageBudget||0,u=await l.Z.aggregate([{$match:{postedBy:r.userId}},{$group:{_id:"$category",count:{$sum:1}}},{$project:{category:"$_id",count:1,_id:0}}]);return s.NextResponse.json({totalJobsPosted:a,totalJobsCompleted:n,averageJobBudget:i,jobsByCategory:u})}catch(e){return console.error("Error fetching analytics:",e),s.NextResponse.json({error:"Error fetching analytics"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/analytics/route",pathname:"/api/analytics",filename:"route",bundlePath:"app/api/analytics/route"},resolvedPagePath:"/Users/hunterricks/Downloads/stackblitz-starters-3acn8s (7)/app/api/analytics/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:y,serverHooks:h}=m,f="/api/analytics/route";function v(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:y})}},2021:(e,t,r)=>{r.d(t,{Z:()=>s});var a=r(11185),n=r.n(a);if(!process.env.MONGODB_URI)throw Error("Please define the MONGODB_URI environment variable");let o=process.env.MONGODB_URI,i=global.mongooseCache;i||(i=global.mongooseCache={conn:null,promise:null});let s=async function(){if(i.conn)return i.conn;i.promise||(i.promise=n().connect(o,{bufferCommands:!1}).then(e=>e.connection));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}},7998:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(11185),n=r.n(a);r(71732);let o=new(n()).Schema({title:{type:String,required:[!0,"Please provide a title for this job."],maxlength:[100,"Title cannot be more than 100 characters"]},description:{type:String,required:[!0,"Please provide a description for this job."],maxlength:[2e3,"Description cannot be more than 2000 characters"]},category:{type:String,required:[!0,"Please specify the category of this job."],enum:["renovation","plumbing","electrical","painting","landscaping","cleaning","other"]},location:{type:String,required:[!0,"Please specify the location for this job."]},budget:{type:Number,min:[0,"Budget cannot be negative"]},minHourlyRate:{type:Number,min:[0,"Hourly rate cannot be negative"]},maxHourlyRate:{type:Number,min:[0,"Hourly rate cannot be negative"]},budgetType:{type:String,enum:["fixed","hourly"],required:[!0,"Please specify the budget type."]},scope:{type:String,required:[!0,"Please specify the scope of this job."],enum:["small","medium","large"]},duration:{type:String,required:[!0,"Please specify the duration of this job."],enum:["1-3","3-6","6+"]},experienceLevel:{type:String,required:[!0,"Please specify the required experience level."],enum:["entry","intermediate","expert"]},skills:[{type:String,required:[!0,"Please specify at least one required skill."]}],postedBy:{type:n().Schema.Types.ObjectId,ref:"User",required:[!0,"Please provide the user who posted this job."]},status:{type:String,enum:["open","in_progress","completed","cancelled"],default:"open"},paymentStatus:{type:String,enum:["pending","escrow","released","refunded"],default:"pending"},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}});o.pre("save",function(e){this.updatedAt=new Date,e()});let i=n().models.Job||n().model("Job",o)},71732:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(11185),n=r.n(a);let o=new(n()).Schema({name:{type:String,required:[!0,"Please provide a name"],maxlength:[60,"Name cannot be more than 60 characters"]},email:{type:String,required:[!0,"Please provide an email"],unique:!0,lowercase:!0,trim:!0},password:{type:String,required:[!0,"Please provide a password"],minlength:[8,"Password must be at least 8 characters long"]},fcmTokens:[{type:String}],createdAt:{type:Date,default:Date.now}}),i=n().models.User||n().model("User",o)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972,1482],()=>r(16147));module.exports=a})();