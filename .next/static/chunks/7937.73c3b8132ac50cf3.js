"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7937],{7937:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var s=a(7437),n=a(7138),l=a(495),o=a(5216),r=a(6463),i=a(2873),d=a(8296),c=a(2699),u=a(9512),m=a(2265),f=a(1622),h=a(7592),x=a(2468),p=a(8165),g=a(7440);let j=f.fC,N=f.xz;f.ZA,f.Uv,f.Tr,f.Ee,m.forwardRef((e,t)=>{let{className:a,inset:n,children:l,...o}=e;return(0,s.jsxs)(f.fF,{ref:t,className:(0,g.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",n&&"pl-8",a),...o,children:[l,(0,s.jsx)(h.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=f.fF.displayName,m.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(f.tu,{ref:t,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})}).displayName=f.tu.displayName;let w=m.forwardRef((e,t)=>{let{className:a,sideOffset:n=4,...l}=e;return(0,s.jsx)(f.Uv,{children:(0,s.jsx)(f.VY,{ref:t,sideOffset:n,className:(0,g.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});w.displayName=f.VY.displayName;let b=m.forwardRef((e,t)=>{let{className:a,inset:n,...l}=e;return(0,s.jsx)(f.ck,{ref:t,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",a),...l})});b.displayName=f.ck.displayName,m.forwardRef((e,t)=>{let{className:a,children:n,checked:l,...o}=e;return(0,s.jsxs)(f.oC,{ref:t,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:l,...o,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(f.wU,{children:(0,s.jsx)(x.Z,{className:"h-4 w-4"})})}),n]})}).displayName=f.oC.displayName,m.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,s.jsxs)(f.Rk,{ref:t,className:(0,g.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(f.wU,{children:(0,s.jsx)(p.Z,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=f.Rk.displayName,m.forwardRef((e,t)=>{let{className:a,inset:n,...l}=e;return(0,s.jsx)(f.__,{ref:t,className:(0,g.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",a),...l})}).displayName=f.__.displayName,m.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(f.Z0,{ref:t,className:(0,g.cn)("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=f.Z0.displayName;var y=a(4174);function v(){let{user:e,switchRole:t}=(0,o.a)(),a=(0,r.useRouter)();if(!(null==e?void 0:e.roles)||e.roles.length<=1)return null;let n=async s=>{s!==e.activeRole&&(t(s),await new Promise(e=>setTimeout(e,0)),a.push("/dashboard/".concat(s)))},i=e=>"homeowner"===e?"Homeowner":"Contractor";return(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[!1,(0,s.jsxs)(j,{children:[(0,s.jsx)(N,{asChild:!0,children:(0,s.jsxs)(l.z,{variant:"outline",className:"gap-2",children:[(0,s.jsx)(y.Z,{className:"h-4 w-4"}),i(e.activeRole)]})}),(0,s.jsx)(w,{align:"end",children:e.roles.map(t=>(0,s.jsxs)(b,{onClick:()=>n(t),className:"gap-2 cursor-pointer ".concat(t===e.activeRole?"bg-primary/5":""),children:[(0,s.jsx)(y.Z,{className:"h-4 w-4"}),"Switch to ",i(t)]},t))})]})]})}var k=a(3304),R=a(2218),z=a(4697);let C=k.fC,Z=k.xz;k.x8;let A=k.h_,S=m.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(k.aV,{className:(0,g.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n,ref:t})});S.displayName=k.aV.displayName;let E=(0,R.j)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),V=m.forwardRef((e,t)=>{let{side:a="right",className:n,children:l,...o}=e;return(0,s.jsxs)(A,{children:[(0,s.jsx)(S,{}),(0,s.jsxs)(k.VY,{ref:t,className:(0,g.cn)(E({side:a}),n),...o,children:[(0,s.jsx)(k.Dx,{className:"sr-only",children:"Sheet Dialog"}),l,(0,s.jsxs)(k.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(z.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});function _(){let e=(0,r.useRouter)(),{logout:t}=(0,o.a)(),a=async()=>{try{window.location.href="/api/auth/logout"}catch(t){console.error("Logout error:",t),e.push("/login")}};return(0,s.jsx)(l.z,{onClick:a,variant:"outline",children:"Log Out"})}function F(){let{user:e}=(0,o.a)(),t=(0,r.useRouter)(),{theme:a,setTheme:f}=(0,u.F)(),[h,x]=(0,m.useState)(!1),[p,g]=(0,m.useState)(!1);(0,m.useEffect)(()=>{x(!0);let e=()=>{g(window.scrollY>10)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);let j=()=>{(null==e?void 0:e.activeRole)?t.push("/dashboard/".concat(e.activeRole)):t.push("/")},N=()=>{f("dark"===a?"light":"dark")},w=()=>(0,s.jsx)(s.Fragment,{children:e?(0,s.jsxs)(s.Fragment,{children:[e.roles&&e.roles.length>1&&(0,s.jsx)(v,{}),(0,s.jsx)(_,{})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.z,{asChild:!0,variant:"outline",children:(0,s.jsx)(n.default,{href:"/login",children:"Log In"})}),(0,s.jsx)(l.z,{asChild:!0,children:(0,s.jsx)(n.default,{href:"/signup",children:"Sign Up"})})]})});return h?(0,s.jsx)("header",{className:"sticky-header ".concat(p?"scrolled shadow-sm":""),children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-4 relative",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between lg:hidden",children:[(0,s.jsxs)(C,{children:[(0,s.jsx)(Z,{asChild:!0,children:(0,s.jsxs)(l.z,{variant:"ghost",size:"icon",children:[(0,s.jsx)(i.Z,{className:"h-6 w-6"}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle menu"})]})}),(0,s.jsx)(V,{side:"left",className:"w-[300px] sm:w-[400px]",children:(0,s.jsx)("nav",{className:"flex flex-col space-y-4 mt-8",children:(0,s.jsx)(w,{})})})]}),(0,s.jsx)("button",{onClick:j,className:"text-2xl font-bold absolute left-1/2 -translate-x-1/2",children:"WHATEVER™"}),(0,s.jsx)(l.z,{variant:"ghost",size:"icon",onClick:N,className:"rounded-full",children:"dark"===a?(0,s.jsx)(d.Z,{className:"h-5 w-5"}):(0,s.jsx)(c.Z,{className:"h-5 w-5"})})]}),(0,s.jsxs)("div",{className:"hidden lg:flex justify-between items-center",children:[(0,s.jsx)("button",{onClick:j,className:"text-2xl font-bold",children:"WHATEVER™"}),(0,s.jsxs)("nav",{className:"flex items-center space-x-4",children:[(0,s.jsx)(w,{}),(0,s.jsx)(l.z,{variant:"ghost",size:"icon",onClick:N,className:"rounded-full",children:"dark"===a?(0,s.jsx)(d.Z,{className:"h-5 w-5"}):(0,s.jsx)(c.Z,{className:"h-5 w-5"})})]})]})]})}):(0,s.jsx)("header",{className:"sticky-header animate-pulse",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"h-10 w-10 bg-muted rounded"}),(0,s.jsx)("div",{className:"h-8 w-32 bg-muted rounded"}),(0,s.jsx)("div",{className:"h-10 w-10 bg-muted rounded"})]})})})}V.displayName=k.VY.displayName,m.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(k.Dx,{ref:t,className:(0,g.cn)("text-lg font-semibold text-foreground",a),...n})}).displayName=k.Dx.displayName,m.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(k.dk,{ref:t,className:(0,g.cn)("text-sm text-muted-foreground",a),...n})}).displayName=k.dk.displayName},5216:function(e,t,a){a.d(t,{a:function(){return d}});var s=a(9099),n=a(9291),l=a(6853),o=a(2649);let r=()=>!1,i=(0,s.Ue)()((0,n.tJ)(e=>({user:null,isAuthenticated:!1,login:t=>{let a=r()?["homeowner","contractor"]:t.roles,s=t.activeRole||a[0];t.token&&o.Z.set("auth-token",t.token,{expires:7,sameSite:"strict",secure:!0,path:"/"}),e({user:{...t,roles:a,activeRole:s},isAuthenticated:!0})},logout:()=>{o.Z.remove("auth-token",{path:"/"}),localStorage.removeItem("auth-storage"),sessionStorage.clear(),e({user:null,isAuthenticated:!1})},switchRole:t=>{e(e=>e.user&&e.user.roles.includes(t)?{...e,user:{...e.user,activeRole:t}}:e)},clearState:()=>{e({user:null,isAuthenticated:!1})}}),{name:"auth-storage",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})})),d=()=>{let{user:e,error:t,isLoading:a}=(0,l.aF)(),{user:s,isAuthenticated:n,login:d,logout:c,switchRole:u}=i();return{user:r()?s:e?{id:e.sub,name:e.name,email:e.email,roles:e["https://myapp.org/roles"]||["homeowner"],activeRole:e["https://myapp.org/activeRole"]||"homeowner"}:null,isAuthenticated:r()?n:!!e,isLoading:!r()&&a,error:r()?null:t,login:d,logout:c,switchRole:u,checkAuth:()=>{if(r()){let e=o.Z.get("auth-token"),t=n&&null!==s&&null!==e;return t||i.getState().clearState(),t}return t?(console.error("Auth0 error:",t),!1):!a&&null!==e}}}}}]);