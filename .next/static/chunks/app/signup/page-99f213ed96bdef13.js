(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4966],{3809:function(e,r,t){Promise.resolve().then(t.bind(t,8029))},8029:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return j}});var n=t(7437),s=t(2265),o=t(9343),a=t(1014),i=t(9772),l=t(495),c=t(2653),u=t(3102),d=t(9324),m=t(2468),f=t(7440);let h=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(d.fC,{ref:r,className:(0,f.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:(0,n.jsx)(d.z$,{className:(0,f.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(m.Z,{className:"h-4 w-4"})})})});h.displayName=d.fC.displayName;var x=t(6463),p=t(7776),g=t(7138),b=t(5216);let v=i.Ry({name:i.Z_().min(2,{message:"Name must be at least 2 characters."}),email:i.Z_().email({message:"Please enter a valid email address."}),password:i.Z_().min(8,{message:"Password must be at least 8 characters."}),roles:i.IX(i.Km(["homeowner","contractor"])).min(1,{message:"Please select at least one role."})});function j(){let[e,r]=(0,s.useState)(!1),t=(0,x.useRouter)(),{login:i}=(0,b.a)(),d=(0,o.cI)({resolver:(0,a.F)(v),defaultValues:{name:"",email:"",password:"",roles:[]}});async function m(e){r(!0);try{let r=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to sign up")}p.Am.success("Sign up successful! Please log in."),t.push("/login")}catch(e){p.Am.error(e.message||"Error signing up. Please try again.")}finally{r(!1)}}return(0,n.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,n.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Create an Account"}),(0,n.jsx)(c.l0,{...d,children:(0,n.jsxs)("form",{onSubmit:d.handleSubmit(m),className:"space-y-8",children:[(0,n.jsx)(c.Wi,{control:d.control,name:"name",render:e=>{let{field:r}=e;return(0,n.jsxs)(c.xJ,{children:[(0,n.jsx)(c.lX,{children:"Full Name"}),(0,n.jsx)(c.NI,{children:(0,n.jsx)(u.I,{placeholder:"John Doe",...r})}),(0,n.jsx)(c.zG,{})]})}}),(0,n.jsx)(c.Wi,{control:d.control,name:"email",render:e=>{let{field:r}=e;return(0,n.jsxs)(c.xJ,{children:[(0,n.jsx)(c.lX,{children:"Email"}),(0,n.jsx)(c.NI,{children:(0,n.jsx)(u.I,{type:"email",placeholder:"john@example.com",...r})}),(0,n.jsx)(c.zG,{})]})}}),(0,n.jsx)(c.Wi,{control:d.control,name:"password",render:e=>{let{field:r}=e;return(0,n.jsxs)(c.xJ,{children:[(0,n.jsx)(c.lX,{children:"Password"}),(0,n.jsx)(c.NI,{children:(0,n.jsx)(u.I,{type:"password",placeholder:"********",...r})}),(0,n.jsx)(c.zG,{})]})}}),(0,n.jsx)(c.Wi,{control:d.control,name:"roles",render:()=>(0,n.jsxs)(c.xJ,{children:[(0,n.jsx)(c.lX,{children:"I want to..."}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(h,{id:"homeowner",onCheckedChange:e=>{let r=d.getValues().roles;e?d.setValue("roles",[...r,"homeowner"]):d.setValue("roles",r.filter(e=>"homeowner"!==e))}}),(0,n.jsx)("label",{htmlFor:"homeowner",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Hire for projects (Homeowner)"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(h,{id:"contractor",onCheckedChange:e=>{let r=d.getValues().roles;e?d.setValue("roles",[...r,"contractor"]):d.setValue("roles",r.filter(e=>"contractor"!==e))}}),(0,n.jsx)("label",{htmlFor:"contractor",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Work on projects (Contractor)"})]})]}),(0,n.jsx)(c.zG,{})]})}),(0,n.jsx)(l.z,{type:"submit",disabled:e,className:"w-full",children:e?"Creating Account...":"Create Account"})]})}),(0,n.jsxs)("p",{className:"mt-4 text-center text-sm text-muted-foreground",children:["Already have an account?"," ",(0,n.jsx)(g.default,{href:"/login",className:"text-primary hover:underline",children:"Log in"})]})]})})}},495:function(e,r,t){"use strict";t.d(r,{z:function(){return c}});var n=t(7437),s=t(2265),o=t(1538),a=t(2218),i=t(7440);let l=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,r)=>{let{className:t,variant:s,size:a,asChild:c=!1,...u}=e,d=c?o.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(l({variant:s,size:a,className:t})),ref:r,...u})});c.displayName="Button"},2653:function(e,r,t){"use strict";t.d(r,{NI:function(){return p},Wi:function(){return d},l0:function(){return c},lX:function(){return x},pf:function(){return g},xJ:function(){return h},zG:function(){return b}});var n=t(7437),s=t(2265),o=t(1538),a=t(9343),i=t(7440),l=t(7135);let c=a.RV,u=s.createContext({}),d=e=>{let{...r}=e;return(0,n.jsx)(u.Provider,{value:{name:r.name},children:(0,n.jsx)(a.Qr,{...r})})},m=()=>{let e=s.useContext(u),r=s.useContext(f),{getFieldState:t,formState:n}=(0,a.Gc)(),o=t(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=r;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...o}},f=s.createContext({}),h=s.forwardRef((e,r)=>{let{className:t,...o}=e,a=s.useId();return(0,n.jsx)(f.Provider,{value:{id:a},children:(0,n.jsx)("div",{ref:r,className:(0,i.cn)("space-y-2",t),...o})})});h.displayName="FormItem";let x=s.forwardRef((e,r)=>{let{className:t,...s}=e,{error:o,formItemId:a}=m();return(0,n.jsx)(l._,{ref:r,className:(0,i.cn)(o&&"text-destructive",t),htmlFor:a,...s})});x.displayName="FormLabel";let p=s.forwardRef((e,r)=>{let{...t}=e,{error:s,formItemId:a,formDescriptionId:i,formMessageId:l}=m();return(0,n.jsx)(o.g7,{ref:r,id:a,"aria-describedby":s?"".concat(i," ").concat(l):"".concat(i),"aria-invalid":!!s,...t})});p.displayName="FormControl";let g=s.forwardRef((e,r)=>{let{className:t,...s}=e,{formDescriptionId:o}=m();return(0,n.jsx)("p",{ref:r,id:o,className:(0,i.cn)("text-sm text-muted-foreground",t),...s})});g.displayName="FormDescription";let b=s.forwardRef((e,r)=>{let{className:t,children:s,...o}=e,{error:a,formMessageId:l}=m(),c=a?String(null==a?void 0:a.message):s;return c?(0,n.jsx)("p",{ref:r,id:l,className:(0,i.cn)("text-sm font-medium text-destructive",t),...o,children:c}):null});b.displayName="FormMessage"},3102:function(e,r,t){"use strict";t.d(r,{I:function(){return a}});var n=t(7437),s=t(2265),o=t(7440);let a=s.forwardRef((e,r)=>{let{className:t,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...a})});a.displayName="Input"},7135:function(e,r,t){"use strict";t.d(r,{_:function(){return c}});var n=t(7437),s=t(2265),o=t(8364),a=t(2218),i=t(7440);let l=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(o.f,{ref:r,className:(0,i.cn)(l(),t),...s})});c.displayName=o.f.displayName},5216:function(e,r,t){"use strict";t.d(r,{a:function(){return c}});var n=t(9099),s=t(9291),o=t(6853),a=t(2649);let i=()=>!1,l=(0,n.Ue)()((0,s.tJ)(e=>({user:null,isAuthenticated:!1,login:r=>{let t=i()?["homeowner","contractor"]:r.roles,n=r.activeRole||t[0];r.token&&a.Z.set("auth-token",r.token,{expires:7,sameSite:"strict",secure:!0,path:"/"}),e({user:{...r,roles:t,activeRole:n},isAuthenticated:!0})},logout:()=>{a.Z.remove("auth-token",{path:"/"}),localStorage.removeItem("auth-storage"),sessionStorage.clear(),e({user:null,isAuthenticated:!1})},switchRole:r=>{e(e=>e.user&&e.user.roles.includes(r)?{...e,user:{...e.user,activeRole:r}}:e)},clearState:()=>{e({user:null,isAuthenticated:!1})}}),{name:"auth-storage",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})})),c=()=>{let{user:e,error:r,isLoading:t}=(0,o.aF)(),{user:n,isAuthenticated:s,login:c,logout:u,switchRole:d}=l();return{user:i()?n:e?{id:e.sub,name:e.name,email:e.email,roles:e["https://myapp.org/roles"]||["homeowner"],activeRole:e["https://myapp.org/activeRole"]||"homeowner"}:null,isAuthenticated:i()?s:!!e,isLoading:!i()&&t,error:i()?null:r,login:c,logout:u,switchRole:d,checkAuth:()=>{if(i()){let e=a.Z.get("auth-token"),r=s&&null!==n&&null!==e;return r||l.getState().clearState(),r}return r?(console.error("Auth0 error:",r),!1):!t&&null!==e}}}},7440:function(e,r,t){"use strict";t.d(r,{cn:function(){return o}});var n=t(4839),s=t(6164);function o(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,n.W)(r))}}},function(e){e.O(0,[2183,231,4314,6853,7776,1336,4065,2971,7023,1744],function(){return e(e.s=3809)}),_N_E=e.O()}]);