(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7647],{2821:function(e,t,r){Promise.resolve().then(r.bind(r,1436))},1436:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var n=r(7437),s=r(2265),a=r(5216),o=r(6463),i=r(6013),l=r(4693),u=r(495),c=r(7138),d=r(7776);function f(){let[e,t]=(0,s.useState)([]),[r,f]=(0,s.useState)(!0),{user:m,checkAuth:h}=(0,a.a)(),p=(0,o.useRouter)();(0,s.useEffect)(()=>{if(!h()){p.push("/login");return}if((null==m?void 0:m.activeRole)!=="contractor"){p.push("/dashboard/homeowner");return}x()},[m,p,h]);let x=async()=>{try{f(!0);let e=await fetch("/api/proposals?serviceProvider=".concat(null==m?void 0:m.id));if(!e.ok)throw Error("Failed to fetch proposals");let r=await e.json();t(r)}catch(e){d.Am.error("Error fetching proposals")}finally{f(!1)}},b=e=>(0,n.jsx)(l.C,{variant:{pending:"secondary",accepted:"default",rejected:"destructive"}[e],children:e});return m&&"contractor"===m.activeRole?(0,n.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"My Proposals"}),(0,n.jsx)(u.z,{asChild:!0,children:(0,n.jsx)(c.default,{href:"/browse-jobs",children:"Browse More Jobs"})})]}),r?(0,n.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,n.jsxs)("div",{className:"space-y-6",children:[e.map(e=>(0,n.jsxs)(i.Zb,{children:[(0,n.jsx)(i.Ol,{children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(i.ll,{className:"text-xl mb-2",children:e.job.title}),b(e.status)]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsxs)("p",{className:"font-medium",children:["$",e.price]}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:e.estimatedDuration})]})]})}),(0,n.jsx)(i.aY,{children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Submitted on ",new Date(e.createdAt).toLocaleDateString()]}),(0,n.jsx)(u.z,{asChild:!0,children:(0,n.jsx)(c.default,{href:"/jobs/".concat(e.job._id),children:"View Job"})})]})})]},e._id)),!r&&0===e.length&&(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("p",{className:"text-lg text-muted-foreground",children:"You haven't submitted any proposals yet."}),(0,n.jsx)(u.z,{asChild:!0,className:"mt-4",children:(0,n.jsx)(c.default,{href:"/browse-jobs",children:"Browse Available Jobs"})})]})]})]}):null}},4693:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var n=r(7437);r(2265);var s=r(2218),a=r(7440);let o=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...s}=e;return(0,n.jsx)("div",{className:(0,a.cn)(o({variant:r}),t),...s})}},495:function(e,t,r){"use strict";r.d(t,{z:function(){return u}});var n=r(7437),s=r(2265),a=r(1538),o=r(2218),i=r(7440);let l=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:u=!1,...c}=e,d=u?a.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(l({variant:s,size:o,className:r})),ref:t,...c})});u.displayName="Button"},6013:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return u},Zb:function(){return o},aY:function(){return c},eW:function(){return d},ll:function(){return l}});var n=r(7437),s=r(2265),a=r(7440);let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});o.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("h3",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});l.displayName="CardTitle";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...s})});u.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...s})});d.displayName="CardFooter"},5216:function(e,t,r){"use strict";r.d(t,{a:function(){return u}});var n=r(9099),s=r(9291),a=r(6853),o=r(2649);let i=()=>!1,l=(0,n.Ue)()((0,s.tJ)(e=>({user:null,isAuthenticated:!1,login:t=>{let r=i()?["homeowner","contractor"]:t.roles,n=t.activeRole||r[0];t.token&&o.Z.set("auth-token",t.token,{expires:7,sameSite:"strict",secure:!0,path:"/"}),e({user:{...t,roles:r,activeRole:n},isAuthenticated:!0})},logout:()=>{o.Z.remove("auth-token",{path:"/"}),localStorage.removeItem("auth-storage"),sessionStorage.clear(),e({user:null,isAuthenticated:!1})},switchRole:t=>{e(e=>e.user&&e.user.roles.includes(t)?{...e,user:{...e.user,activeRole:t}}:e)},clearState:()=>{e({user:null,isAuthenticated:!1})}}),{name:"auth-storage",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated})})),u=()=>{let{user:e,error:t,isLoading:r}=(0,a.aF)(),{user:n,isAuthenticated:s,login:u,logout:c,switchRole:d}=l();return{user:i()?n:e?{id:e.sub,name:e.name,email:e.email,roles:e["https://myapp.org/roles"]||["homeowner"],activeRole:e["https://myapp.org/activeRole"]||"homeowner"}:null,isAuthenticated:i()?s:!!e,isLoading:!i()&&r,error:i()?null:t,login:u,logout:c,switchRole:d,checkAuth:()=>{if(i()){let e=o.Z.get("auth-token"),t=s&&null!==n&&null!==e;return t||l.getState().clearState(),t}return t?(console.error("Auth0 error:",t),!1):!r&&null!==e}}}},7440:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(4839),s=r(6164);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}},7138:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var n=r(231),s=r.n(n)},9189:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{cancelIdleCallback:function(){return n},requestIdleCallback:function(){return r}});let r="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},n="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}},function(e){e.O(0,[2183,231,4314,6853,7776,2971,7023,1744],function(){return e(e.s=2821)}),_N_E=e.O()}]);